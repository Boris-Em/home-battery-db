---
import type { Battery } from '../types/battery';

interface Props {
  battery: Battery;
}

const { battery } = Astro.props;

const backupLabel = {
  none: 'No backup',
  essential_circuits: 'Essential backup',
  whole_home: 'Whole-home backup',
};

const chemistryColor = {
  LFP: 'bg-green-100 text-green-800',
  NMC: 'bg-blue-100 text-blue-800',
  NCA: 'bg-purple-100 text-purple-800',
  Other: 'bg-gray-100 text-gray-800',
};
---

<a
  href={`/batteries/${battery.slug}`}
  class="flex items-center gap-6 rounded-xl border border-gray-200 bg-white px-5 py-4 shadow-sm transition hover:shadow-md hover:border-gray-300"
>
  <!-- Name -->
  <div class="min-w-0 w-48 shrink-0">
    <p class="text-xs font-medium text-gray-500">{battery.brand_name}</p>
    <h2 class="truncate text-base font-semibold text-gray-900">{battery.model}</h2>
  </div>

  <!-- Chemistry badge -->
  <span class={`shrink-0 rounded-full px-2.5 py-0.5 text-xs font-medium ${chemistryColor[battery.chemistry]}`}>
    {battery.chemistry}
  </span>

  <!-- Specs -->
  <div class="flex flex-1 items-center gap-6 text-sm">
    <div class="w-24">
      <p class="text-xs text-gray-500">Capacity</p>
      <p class="font-semibold text-gray-900">{battery.usable_capacity_kwh} kWh</p>
    </div>
    <div class="w-28">
      <p class="text-xs text-gray-500">Cont. power</p>
      <p class="font-semibold text-gray-900">{battery.continuous_power_kw} kW</p>
    </div>
    <div class="w-36 hidden md:block">
      <p class="text-xs text-gray-500">Backup</p>
      <p class="font-semibold text-gray-900">{backupLabel[battery.backup_type]}</p>
    </div>
    <div class="w-20 hidden lg:block">
      <p class="text-xs text-gray-500">Warranty</p>
      <p class="font-semibold text-gray-900">{battery.warranty_years ? `${battery.warranty_years} yr` : '—'}</p>
    </div>
  </div>

  <!-- Markets + price -->
  <div class="flex shrink-0 items-center gap-4">
    <div class="flex gap-1">
      {battery.available_nl ? <span class="rounded bg-gray-100 px-1.5 py-0.5 text-xs text-gray-600">NL</span> : null}
      {battery.available_fr ? <span class="rounded bg-gray-100 px-1.5 py-0.5 text-xs text-gray-600">FR</span> : null}
      {battery.available_us ? <span class="rounded bg-gray-100 px-1.5 py-0.5 text-xs text-gray-600">US</span> : null}
    </div>
    <div class="w-24 text-right">
      {battery.price_us
        ? <p class="text-sm font-medium text-gray-900">from ${battery.price_us.toLocaleString()}</p>
        : battery.price_nl
        ? <p class="text-sm font-medium text-gray-900">from €{battery.price_nl.toLocaleString()}</p>
        : <p class="text-sm text-gray-400">—</p>}
    </div>
  </div>
</a>
